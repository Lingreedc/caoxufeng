{% extends 'base.html' %}
{% load comments %}
{% block title %}{{ post.title }}{% endblock title %}
{% block sidebar_btn %}
    <a class="show-on-mobile nav-link mr" id="js-sidebar-btn" href="#" role="button">
        <i class="fa fa-chevron-right" aria-hidden="true"></i>
    </a>
{% endblock sidebar_btn %}
{% block units_gap %}{% endblock %}
{% block main %}
    <div class="unit-1-4 unit-1-on-mobile top-gap" id="toc-sidebar">
        <div class="scroll-view bg-white card toc-sidebar toc-sidebar-tutorial">
            <div class="card-header">
                目录
            </div>
            <h5 class="top-gap"><a href="">{{ post.category }}</a></h5>
            <div class="toc">
                <ul>
                    {% for tutorial_post in post_list %}
                        <li>
                            <a href="{{ tutorial_post.get_absolute_url }}">{{ tutorial_post.title }}</a>
                            {% if tutorial_post.pk == post.pk %}
                                {{ post.toc |safe }}
                            {% endif %}
                        </li>
                    {% endfor %}
                </ul>
            </div>
        </div>
    </div>
{% endblock main %}
{% block side %}
    <div class="unit-3-4 unit-1-on-mobile top-gap">
        <div class="bg-white card post-card">
            {% include 'blog/_post_detail_item.html' %}
            <div class="top-gap">
                {% if previous_post %}
                    <a href="{{ previous_post.get_absolute_url }}">
                        <i class="fa fa-angle-double-left" aria-hidden="true"></i>
                        {{ previous_post }}
                    </a>
                {% endif %}
                {% if next_post %}
                    <a href="{{ next_post.get_absolute_url }}" style="float: right">
                        {{ next_post }}
                        <i class="fa fa-angle-double-right" aria-hidden="true"></i>
                    </a>
                {% endif %}
            </div>
            <section class="comment-area top-gap-big" id="comment-area">
                <h5>{{ post.comments.count }} 条评论 / {{ post.participants_count }} 人参与</h5>
                {% if user.is_authenticated %}
                    {% render_comment_form for post %}
                {% else %}
                    {% include 'account/_login_panel.html' %}
                {% endif %}
                {% include 'comments/list.html' %}
            </section>
        </div>
    </div>
{% endblock side %}